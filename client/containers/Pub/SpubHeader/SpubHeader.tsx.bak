import React, { useState } from 'react';
import { Tab, Tabs, TabId } from '@blueprintjs/core';
import classNames from 'classnames';

// import { GridWrapper } from 'components';
import { usePageContext } from 'utils/hooks';

import InstructionsTab from './InstructionsTab';
import SubmissionTab from './SubmissionTab';
import PreviewTab from './PreviewTab';
import PubHeaderBackground from '../PubHeader/PubHeaderBackground';
import { renderInstructionTabTitle } from './utility';

require('./spubHeader.scss');

type Props = {
	pubData: any;
};

const SpubHeader = (props: Props) => {
	const { submissionWorkflow } = props.pubData.submission || {};
	const [selectedTab, setSelectedTab] = useState<TabId>('instructions');
	const { communityData } = usePageContext();
	if (!submissionWorkflow) return null;
	const { instructionsText } = submissionWorkflow;

	const instructions = renderInstructionTabTitle('align-left', 'Instructions');
	const submissionTabTitle = renderInstructionTabTitle('manually-entered-data', 'Submission');
	const preview = renderInstructionTabTitle('eye-open', 'Preview & Submit');

	return (
		<div>
			<Tabs
				id="TabsExample"
				onChange={(t) => setSelectedTab(t)}
				selectedTabId={selectedTab}
				className="tabs bp3-large"
			>
				<Tab
					id="instructions"
					title={instructions}
					panel={<InstructionsTab instructions={instructionsText} />}
					className="tab-panel tab"
				/>

				<Tab
					id="submission"
					title={submissionTabTitle}
					panel={<SubmissionTab />}
					className="tab-panel tab"
				/>
				<Tab
					id="preview"
					title={preview}
					panel={
						<PubHeaderBackground
							className={classNames(
								'pub-header-component',
								selectedTab === 'preview' && 'is-showing-preview',
							)}
							communityData={communityData}
							pubData={props.pubData}
						>
							<PreviewTab pubData={props.pubData} />
						</PubHeaderBackground>
					}
					className="tab-panel tab"
				/>
			</Tabs>
		</div>
	);
};

export default SpubHeader;
